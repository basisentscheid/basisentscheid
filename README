
=== Installation ===

requirements:
- PHP >= 5.4 with modules:
  - apache2, cgi or whatever you like to use
  - cli
  - postgres
  - gettext
  - session
  - unicode
  - gnupg PECL module http://pecl.php.net/package/gnupg (only if you want to sign/encrypt emails)
- PostgreSQL (works at least with 9.1 and 9.3)
- GnuPG (only if you want to sign/encrypt emails)

generate PGP keys (only if you want to sign/encrypt emails):
$ gpg --homedir <base>/var/gnupg --gen-key
Leave the passphrase empty.

send the public key to a key server:
Maybe you have to remove some permissions, because gpg refuses to upload the key otherwise:
$ chmod g-rwx gnupg/
$ gpg --homedir <base>/var/gnupg --keyserver hkp://keys.gnupg.net --send-keys <key-id>

The directory /var/ and all subdirectories need write access for the users as which PHP runs for web and cli. For
example you could use a group with the user of the webserver. Usually a group called www-data, apache or httpd is
already provided by the system, but you could also create a new group for this. The cli user could own the files or
also be added to the group.
# find var/ -exec chgrp www-data {} \;
$ find var/ -type d -exec chmod 770 {} \;
$ find var/ -type f -exec chmod 660 {} \;

For PHP configuration and for blocking access to some directories, use the provided .htaccess files or copy their
contents to the webserver config.

configuration:
$ cd inc/
$ cp config_example.php config.php
$ vi config.php

create database:
In Postgres create an empty database and make the role you're going to use owner of the schema "public" in that
database. Enter database name, role and password if needed to config.php. Then run:
$ db/recreate_schema.sh

create initial data:
$ cli/create_admin.php
$ cli/create_ngroups.php

run tests:
$ cli/test.php
$ cli/test_ballots.php


=== License ===

Copyright 2014 Magnus Rosenbaum <dev@cmr.cx>

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU Affero General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU Affero General Public License for more details.

You should have received a copy of the GNU Affero General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
